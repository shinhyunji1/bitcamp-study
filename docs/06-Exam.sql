### 3. 실습 - where 조건절 활용

CREATE TABLE CUST_PERF
(
	ID CHAR(4) PRIMARY KEY NOT NULL,
	NAME CHAR(10) NOT NULL,
	SEG CHAR(10) NOT NULL,
	TOT_AMT_1 DECIMAL(15,0),
	TOT_AMT_2 DECIMAL(15,0),
	TOT_AMT_3 DECIMAL(15,0),
	CITY CHAR(10),
	COUNTRY CHAR(10)
);

INSERT INTO CUST_PERF VALUES ('1', 'SUE', 'PRIORITY', 790, 1770, 4780, 'BERLIN', 'GERMANY');
INSERT INTO CUST_PERF VALUES ('2', 'DAVID', 'MASS', 90700, 5789, 87986, 'BERN', 'SWITZERLAND');
INSERT INTO CUST_PERF VALUES ('3', 'SAM', 'MASS', 0, 0, 0, 'NANTES', 'FRANCE');
INSERT INTO CUST_PERF VALUES ('4', 'KIM', 'MASS', 88805, 659860, 5130, 'BERGAMO', 'BRAZIL');
INSERT INTO CUST_PERF VALUES ('5', 'LEE', 'PRIORITY', 9846000, 5708900, 7600000, 'VERSAILLES', 'FRANCE');
INSERT INTO CUST_PERF VALUES ('6', 'BERNEY', 'MASS', 0, 6000, 0, 'BERGAMO', 'ITALY');
INSERT INTO CUST_PERF VALUES ('7', 'SANDY', 'PRIORITY', 1000400, 788000, 2378696, 'BERLIN', 'GERMANY');
INSERT INTO CUST_PERF VALUES ('8', 'YOUNG', 'MASS', 0, 0, 0, 'SEOUL', 'KOREA');
INSERT INTO CUST_PERF VALUES ('9', 'SALLY', 'MASS', 540, 0, 7700, 'TOKYO', 'JAPAN');
INSERT INTO CUST_PERF VALUES ('10', 'BRIAN', 'MASS', 254860, 578321, 432004, 'PUSAN', 'KOREA');
INSERT INTO CUST_PERF VALUES ('11', 'CHRISTINA', 'PRIORITY', 687063, 870000, 545400, 'OSAKA', 'JAPAN');

select * from CUST_PERF
where city like '%es%'
and coalesce(TOT_AMT_1, 0) >= 3000000
and coalesce(TOT_AMT_2, 0) >= 3000000
and coalesce(TOT_AMT_3, 0) >= 3000000;

select 'DEAR '||TRIM(NAME)||', '||' YOUR SEGMENT IS '||TRIM(SEG)||' IN OUR COMPANY.' as DN_DE
from CUST_PERF
where city like '%es%'
and coalesce(TOT_AMT_1, 0) >= 3000000
and coalesce(TOT_AMT_2, 0) >= 3000000
and coalesce(TOT_AMT_3, 0) >= 3000000;
